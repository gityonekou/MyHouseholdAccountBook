# マイ家計簿アプリケーション 開発環境設定

**作成日**: 2025年11月18日
**対象システム**: MyHouseholdAccountBook
**開発環境**: Windows

---

## 目次

1. [前提条件](#1-前提条件)
2. [Java環境](#2-java環境)
3. [Maven環境](#3-maven環境)
4. [IDE設定](#4-ide設定)
5. [データベース環境](#5-データベース環境)
6. [環境変数設定](#6-環境変数設定)
7. [動作確認](#7-動作確認)

---

## 1. 前提条件

### 1.1 必須ソフトウェア

| ソフトウェア | バージョン | 備考 |
|-------------|-----------|------|
| Java | 17 | Pleiades版を使用 |
| Maven | 3.9.9 | Pleiades版を使用 |
| Visual Studio Code | 最新版 | IDE |
| Git | 最新版 | バージョン管理 |

### 1.2 推奨ソフトウェア

- Chrome/Edge（動作確認用ブラウザ）
- MySQL Workbench（DB管理ツール）

---

## 2. Java環境

### 2.1 インストール情報

```
Java バージョン: 17
インストールパス: C:\pleiades\java_base\java_base_17
ディストリビューション: Pleiades All in One
```

### 2.2 環境変数設定

#### JAVA_HOME

```
変数名: JAVA_HOME
値: C:\pleiades\java_base\java_base_17
```

#### PATH

```
既存のPATHに以下を追加:
%JAVA_HOME%\bin
```

### 2.3 確認コマンド

```bash
# Javaバージョン確認
java -version

# 出力例:
# openjdk version "17.x.x" 2024-xx-xx
# OpenJDK Runtime Environment (build 17.x.x+x)
# OpenJDK 64-Bit Server VM (build 17.x.x+x, mixed mode, sharing)

# JAVA_HOME確認
echo %JAVA_HOME%

# 出力例:
# C:\pleiades\java_base\java_base_17
```

---

## 3. Maven環境

### 3.1 インストール情報

```
Maven バージョン: 3.9.9
インストールパス: C:\pleiades\maven\apache-maven-3.9.9
ディストリビューション: Pleiades All in One
```

### 3.2 環境変数設定

#### MAVEN_HOME（オプション）

```
変数名: MAVEN_HOME
値: C:\pleiades\maven\apache-maven-3.9.9
```

#### PATH

```
既存のPATHに以下を追加:
C:\pleiades\maven\apache-maven-3.9.9\bin
```

### 3.3 確認コマンド

```bash
# Mavenバージョン確認
mvn -version

# 出力例:
# Apache Maven 3.9.9
# Maven home: C:\pleiades\maven\apache-maven-3.9.9
# Java version: 17.x.x, vendor: Oracle Corporation
# Default locale: ja_JP, platform encoding: MS932
```

### 3.4 Maven Wrapper

プロジェクトにはMaven Wrapperが含まれています:

```
mvnw        # Unix/Linux/Mac用
mvnw.cmd    # Windows用
```

Maven Wrapperを使用する場合、Mavenのインストールは不要ですが、JAVA_HOMEの設定は必須です。

---

## 4. IDE設定

### 4.1 Visual Studio Code

#### 4.1.1 必須拡張機能

以下の拡張機能をインストールしてください:

| 拡張機能 | 説明 |
|---------|------|
| Extension Pack for Java | Java開発の基本パック |
| Spring Boot Extension Pack | Spring Boot開発支援 |
| Lombok Annotations Support for VS Code | Lombok サポート |
| Test Runner for Java | JUnitテスト実行 |

#### 4.1.2 推奨拡張機能

| 拡張機能 | 説明 |
|---------|------|
| GitLens | Git履歴の可視化 |
| Prettier | コードフォーマッター |
| Markdown All in One | Markdownサポート |
| Japanese Language Pack | 日本語化 |

#### 4.1.3 VSCode設定（.vscode/settings.json）

プロジェクトルートに`.vscode/settings.json`を作成することを推奨:

```json
{
  "java.configuration.runtimes": [
    {
      "name": "JavaSE-17",
      "path": "C:\\pleiades\\java_base\\java_base_17"
    }
  ],
  "java.home": "C:\\pleiades\\java_base\\java_base_17",
  "maven.executable.path": "C:\\pleiades\\maven\\apache-maven-3.9.9\\bin\\mvn.cmd",
  "java.compile.nullAnalysis.mode": "automatic",
  "java.configuration.updateBuildConfiguration": "automatic",
  "[java]": {
    "editor.tabSize": 4,
    "editor.insertSpaces": false
  },
  "files.encoding": "utf8",
  "java.jdt.ls.vmargs": "-XX:+UseParallelGC -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90 -Dsun.zip.disableMemoryMapping=true -Xmx2G -Xms100m"
}
```

---

## 5. データベース環境

### 5.1 開発環境

#### H2 Database（テスト用）

```
使用場所: 単体テスト、統合テスト
設定: src/test/resources/application.yml
接続URL: jdbc:h2:mem:testdb
```

#### MySQL（開発・本番用）

```
バージョン: 8.x系
文字コード: utf8mb4
照合順序: utf8mb4_general_ci
タイムゾーン: Asia/Tokyo
```

### 5.2 データベース接続情報（開発環境）

```yaml
# src/main/resources/application.yml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/household_account_book?serverTimezone=JST
    username: root
    password: [各自の環境に合わせて設定]
    driver-class-name: com.mysql.cj.jdbc.Driver
```

**注意**: パスワードは各自の環境に合わせて設定してください。

---

## 6. 環境変数設定

### 6.1 Windows環境変数設定手順

1. 「システムのプロパティ」を開く
   - Win + R → `sysdm.cpl` → Enter

2. 「詳細設定」タブ → 「環境変数」ボタン

3. 「システム環境変数」（または「ユーザー環境変数」）で設定

#### 新規作成する変数

```
JAVA_HOME = C:\pleiades\java_base\java_base_17
MAVEN_HOME = C:\pleiades\maven\apache-maven-3.9.9
```

#### PATH変数に追加

```
%JAVA_HOME%\bin
%MAVEN_HOME%\bin
```

### 6.2 設定後の確認

**重要**: 環境変数設定後は、コマンドプロンプトやVSCodeを再起動してください。

```bash
# 確認コマンド
echo %JAVA_HOME%
echo %MAVEN_HOME%
java -version
mvn -version
```

---

## 7. 動作確認

### 7.1 プロジェクトのクローン

```bash
cd c:\develop\EclipseDevelop\MyWebAppWorkspace
git clone [リポジトリURL]
cd MyHouseholdAccountBook
```

### 7.2 ビルド確認

```bash
# Maven Wrapperを使用する場合
mvnw.cmd clean compile

# Mavenを直接使用する場合
mvn clean compile
```

### 7.3 テスト実行

```bash
# 全テスト実行
mvnw.cmd test

# 特定のテストクラスのみ実行
mvnw.cmd test -Dtest=IncomeAmountTest
```

### 7.4 アプリケーション起動

```bash
# Spring Boot起動
mvnw.cmd spring-boot:run
```

起動後、ブラウザで以下にアクセス:
```
http://localhost:8080
```

### 7.5 VSCodeでの動作確認

1. VSCodeでプロジェクトフォルダを開く
2. Java Projectsビューでプロジェクトが認識されることを確認
3. テストファイル（例: IncomeAmountTest.java）を開く
4. テストメソッドの上に表示される「Run Test」をクリック
5. テストが正常に実行されることを確認

---

## トラブルシューティング

### JAVA_HOME not found エラー

**現象**:
```
Error: JAVA_HOME not found in your environment.
```

**対処法**:
1. 環境変数 `JAVA_HOME` が正しく設定されているか確認
2. コマンドプロンプトを再起動
3. VSCodeを再起動

### Maven実行エラー

**現象**:
```
mvn: command not found
```

**対処法**:
1. 環境変数 `PATH` に `%MAVEN_HOME%\bin` が含まれているか確認
2. コマンドプロンプトを再起動
3. Maven Wrapper (`mvnw.cmd`) を使用する

### Lombokが動作しない

**対処法**:
1. VSCodeに「Lombok Annotations Support」拡張機能をインストール
2. VSCodeを再起動
3. `mvnw.cmd clean compile` を実行

### 文字化け

**現象**:
- コンソール出力が文字化けする

**対処法**:
1. VSCodeの設定で `files.encoding` を `utf8` に設定
2. Windows のコマンドプロンプトの文字コードを確認: `chcp 65001`

---

## 補足情報

### プロジェクト構成

```
MyHouseholdAccountBook/
├── src/
│   ├── main/
│   │   ├── java/              # Javaソースコード
│   │   └── resources/         # 設定ファイル
│   └── test/
│       ├── java/              # テストコード
│       └── resources/         # テスト用設定・データ
├── pom.xml                    # Maven設定ファイル
├── mvnw, mvnw.cmd            # Maven Wrapper
├── 00_開発環境設定.md         # 本ドキュメント
├── 01_現状分析レポート.md
├── 05_DDD設計方針書.md
├── 06_リファクタリング計画書.md
└── 07_テスト方針書.md
```

### 開発フロー

1. ブランチ作成（feature/xxx）
2. コード実装
3. テスト作成・実行（C1網羅100%必須 for ドメイン層）
4. コミット
5. プルリクエスト作成
6. レビュー・マージ

---

**変更履歴**

| 日付 | バージョン | 変更内容 |
|------|-----------|----------|
| 2025/11/18 | 1.0.0 | 初版作成 |
