-- ========================================
-- 月次収支照会機能 統合テスト用データ
-- ========================================
--
-- テストデータの設計ルール（SISYUTU_ITEM_CODEとSISYUTU_ITEM_SORTの採番ルールなど）
-- については、以下のドキュメントを参照してください。
-- docs/test-data-design-rules.md
--
-- ========================================

-- ----------------------------------------
-- 1. ユーザマスタデータ
-- ----------------------------------------
INSERT INTO ACCOUNT_BOOK_USER (USER_ID, NOW_TARGET_YEAR, NOW_TARGET_MONTH, USER_NAME) VALUES
('user01', '2025', '11', 'テストユーザ01');

-- ----------------------------------------
-- 2. 支出項目マスタデータ
-- ----------------------------------------
INSERT INTO SISYUTU_ITEM_TABLE (USER_ID, SISYUTU_ITEM_CODE, SISYUTU_ITEM_NAME, SISYUTU_ITEM_DETAIL_CONTEXT, PARENT_SISYUTU_ITEM_CODE, SISYUTU_ITEM_LEVEL, SISYUTU_ITEM_SORT, ENABLE_UPDATE_FLG) VALUES
('user01', '0001', '食費', '食費関連', '0001', '1', '0100000000', false),
('user01', '0002', '食料品', '食料品購入', '0001', '2', '0101000000', false),
('user01', '0003', '外食', '外食費', '0001', '2', '0102000000', false),
('user01', '0004', '日用品', '日用品関連', '0004', '1', '0200000000', false),
('user01', '0005', '消耗品', '日用消耗品', '0004', '2', '0201000000', false),
('user01', '0006', '趣味娯楽', '趣味娯楽関連', '0006', '1', '0300000000', false),
('user01', '0007', '娯楽', '娯楽費', '0006', '2', '0301000000', false);

-- ----------------------------------------
-- 3. テストケース1: 正常系（データ存在、整合性OK）
--    対象年月: 202511
-- ----------------------------------------

-- 3-1. 収支テーブル
INSERT INTO INCOME_AND_EXPENDITURE_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_KINGAKU, WITHDREW_KINGAKU, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, INCOME_AND_EXPENDITURE_KINGAKU)
VALUES ('user01', '2025', '11', 350000.00, 50000.00, 300000.00, 280000.00, 120000.00);

-- 3-2. 収入テーブル（収入金額合計 = 350000 + 50000 = 400000）
INSERT INTO INCOME_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_CODE, INCOME_KUBUN, INCOME_DETAIL_CONTEXT, INCOME_KINGAKU, DELETE_FLG) VALUES
('user01', '2025', '11', '01', '1', '給与', 300000.00, false),
('user01', '2025', '11', '02', '2', 'ボーナス', 50000.00, false),
('user01', '2025', '11', '03', '3', '積立金取崩', 50000.00, false);

-- 3-3. 支出テーブル（支出金額合計 = 280000）
INSERT INTO EXPENDITURE_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, EXPENDITURE_CODE,
    SISYUTU_ITEM_CODE, EVENT_CODE, EXPENDITURE_NAME, EXPENDITURE_KUBUN,
    EXPENDITURE_DETAIL_CONTEXT, SIHARAI_DATE, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, DELETE_FLG
) VALUES
('user01', '2025', '11', '001', '0002', NULL, 'スーパー買い物', '1', '食料品購入', '2025-11-05', 80000.00, 80000.00, false),
('user01', '2025', '11', '002', '0003', NULL, 'レストラン', '1', '外食', '2025-11-10', 30000.00, 30000.00, false),
('user01', '2025', '11', '003', '0005', NULL, '日用品購入', '1', '消耗品', '2025-11-15', 50000.00, 50000.00, false),
('user01', '2025', '11', '004', '0007', NULL, '映画館', '2', '娯楽費', '2025-11-20', 20000.00, 20000.00, false),
('user01', '2025', '11', '005', '0002', NULL, '食材まとめ買い', '1', '食料品購入', '2025-11-25', 100000.00, 100000.00, false);

-- 3-4. 支出金額テーブル（画面表示用の集計データ）
INSERT INTO SISYUTU_KINGAKU_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, SISYUTU_ITEM_CODE,
    PARENT_SISYUTU_ITEM_CODE, SISYUTU_YOTEI_KINGAKU, SISYUTU_KINGAKU, SISYUTU_KINGAKU_B, SISYUTU_KINGAKU_C, SISYUTU_SIHARAI_DATE
) VALUES
('user01', '2025', '11', '0001', '0001', 220000.00, 210000.00, 180000.00, 30000.00, '2025-11-30'),
('user01', '2025', '11', '0002', '0001', 190000.00, 180000.00, 150000.00, 30000.00, '2025-11-25'),
('user01', '2025', '11', '0003', '0001', 30000.00, 30000.00, 30000.00, 0.00, '2025-11-10'),
('user01', '2025', '11', '0004', '0004', 60000.00, 50000.00, 40000.00, 10000.00, '2025-11-15'),
('user01', '2025', '11', '0005', '0004', 60000.00, 50000.00, 40000.00, 10000.00, '2025-11-15'),
('user01', '2025', '11', '0006', '0006', 20000.00, 20000.00, 20000.00, 0.00, '2025-11-20'),
('user01', '2025', '11', '0007', '0006', 20000.00, 20000.00, 20000.00, 0.00, '2025-11-20');

-- ----------------------------------------
-- 4. テストケース2: 正常系（データなし）
--    対象年月: 202512
-- ----------------------------------------
-- データなし（テストでは空の結果を期待）

-- ----------------------------------------
-- 5. テストケース3: 異常系（収入金額不整合）
--    対象年月: 202510
-- ----------------------------------------

-- 5-1. 収支テーブル
INSERT INTO INCOME_AND_EXPENDITURE_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_KINGAKU, WITHDREW_KINGAKU, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, INCOME_AND_EXPENDITURE_KINGAKU)
VALUES ('user01', '2025', '10', 300000.00, 0.00, 220000.00, 200000.00, 100000.00);

-- 5-2. 収入テーブル（収入金額合計 = 350000 ≠ 収支テーブルの300000 → 不整合）
INSERT INTO INCOME_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_CODE, INCOME_KUBUN, INCOME_DETAIL_CONTEXT, INCOME_KINGAKU, DELETE_FLG) VALUES
('user01', '2025', '10', '01', '1', '給与', 300000.00, false),
('user01', '2025', '10', '02', '2', '臨時収入', 50000.00, false);

-- 5-3. 支出テーブル（支出金額合計 = 200000 → 整合性OK）
INSERT INTO EXPENDITURE_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, EXPENDITURE_CODE,
    SISYUTU_ITEM_CODE, EVENT_CODE, EXPENDITURE_NAME, EXPENDITURE_KUBUN,
    EXPENDITURE_DETAIL_CONTEXT, SIHARAI_DATE, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, DELETE_FLG
) VALUES
('user01', '2025', '10', '001', '0002', NULL, '食費', '1', '食料品', '2025-10-15', 100000.00, 100000.00, false),
('user01', '2025', '10', '002', '0005', NULL, '日用品', '1', '消耗品', '2025-10-20', 100000.00, 100000.00, false);

-- 5-4. 支出金額テーブル
INSERT INTO SISYUTU_KINGAKU_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, SISYUTU_ITEM_CODE,
    PARENT_SISYUTU_ITEM_CODE, SISYUTU_YOTEI_KINGAKU, SISYUTU_KINGAKU, SISYUTU_KINGAKU_B, SISYUTU_KINGAKU_C, SISYUTU_SIHARAI_DATE
) VALUES
('user01', '2025', '10', '0001', '0001', 110000.00, 100000.00, 90000.00, 10000.00, '2025-10-31'),
('user01', '2025', '10', '0002', '0001', 110000.00, 100000.00, 90000.00, 10000.00, '2025-10-15'),
('user01', '2025', '10', '0004', '0004', 110000.00, 100000.00, 80000.00, 20000.00, '2025-10-20'),
('user01', '2025', '10', '0005', '0004', 110000.00, 100000.00, 80000.00, 20000.00, '2025-10-20');

-- ----------------------------------------
-- 6. テストケース4: 異常系（支出金額不整合）
--    対象年月: 202509
-- ----------------------------------------

-- 6-1. 収支テーブル
INSERT INTO INCOME_AND_EXPENDITURE_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_KINGAKU, WITHDREW_KINGAKU, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, INCOME_AND_EXPENDITURE_KINGAKU)
VALUES ('user01', '2025', '09', 400000.00, 0.00, 270000.00, 250000.00, 150000.00);

-- 6-2. 収入テーブル（収入金額合計 = 400000 → 整合性OK）
INSERT INTO INCOME_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_CODE, INCOME_KUBUN, INCOME_DETAIL_CONTEXT, INCOME_KINGAKU, DELETE_FLG) VALUES
('user01', '2025', '09', '01', '1', '給与', 400000.00, false);

-- 6-3. 支出テーブル（支出金額合計 = 300000 ≠ 収支テーブルの250000 → 不整合）
INSERT INTO EXPENDITURE_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, EXPENDITURE_CODE,
    SISYUTU_ITEM_CODE, EVENT_CODE, EXPENDITURE_NAME, EXPENDITURE_KUBUN,
    EXPENDITURE_DETAIL_CONTEXT, SIHARAI_DATE, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, DELETE_FLG
) VALUES
('user01', '2025', '09', '001', '0002', NULL, '食費', '1', '食料品', '2025-09-10', 150000.00, 150000.00, false),
('user01', '2025', '09', '002', '0005', NULL, '日用品', '1', '消耗品', '2025-09-15', 100000.00, 100000.00, false),
('user01', '2025', '09', '003', '0007', NULL, '娯楽', '2', '娯楽費', '2025-09-20', 50000.00, 50000.00, false);

-- 6-4. 支出金額テーブル
INSERT INTO SISYUTU_KINGAKU_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, SISYUTU_ITEM_CODE,
    PARENT_SISYUTU_ITEM_CODE, SISYUTU_YOTEI_KINGAKU, SISYUTU_KINGAKU, SISYUTU_KINGAKU_B, SISYUTU_KINGAKU_C, SISYUTU_SIHARAI_DATE
) VALUES
('user01', '2025', '09', '0001', '0001', 160000.00, 150000.00, 130000.00, 20000.00, '2025-09-30'),
('user01', '2025', '09', '0002', '0001', 160000.00, 150000.00, 130000.00, 20000.00, '2025-09-10'),
('user01', '2025', '09', '0004', '0004', 110000.00, 100000.00, 90000.00, 10000.00, '2025-09-15'),
('user01', '2025', '09', '0005', '0004', 110000.00, 100000.00, 90000.00, 10000.00, '2025-09-15'),
('user01', '2025', '09', '0006', '0006', 50000.00, 50000.00, 50000.00, 0.00, '2025-09-20'),
('user01', '2025', '09', '0007', '0006', 50000.00, 50000.00, 50000.00, 0.00, '2025-09-20');

-- ----------------------------------------
-- 7. テストケース5: 異常系（収支データなし、支出データあり）
--    対象年月: 202508
-- ----------------------------------------

-- 7-1. 収支テーブル（データなし）

-- 7-2. 支出金額テーブル（不正データ: 収支データなしで支出データが存在）
INSERT INTO SISYUTU_KINGAKU_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, SISYUTU_ITEM_CODE,
    PARENT_SISYUTU_ITEM_CODE, SISYUTU_YOTEI_KINGAKU, SISYUTU_KINGAKU, SISYUTU_KINGAKU_B, SISYUTU_KINGAKU_C, SISYUTU_SIHARAI_DATE
) VALUES
('user01', '2025', '08', '0001', '0001', 110000.00, 100000.00, 90000.00, 10000.00, '2025-08-31'),
('user01', '2025', '08', '0002', '0001', 110000.00, 100000.00, 90000.00, 10000.00, '2025-08-15');

-- ----------------------------------------
-- 8. テストケース6: 正常系（積立金取崩金額なし）
--    対象年月: 202601
-- ----------------------------------------

-- 8-1. 収支テーブル（積立金取崩金額 = null）
INSERT INTO INCOME_AND_EXPENDITURE_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_KINGAKU, WITHDREW_KINGAKU, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, INCOME_AND_EXPENDITURE_KINGAKU)
VALUES ('user01', '2026', '01', 300000.00, null, 250000.00, 240000.00, 60000.00);

-- 8-2. 収入テーブル（収入金額合計 = 300000、積立金取崩しなし）
INSERT INTO INCOME_TABLE (USER_ID, TARGET_YEAR, TARGET_MONTH, INCOME_CODE, INCOME_KUBUN, INCOME_DETAIL_CONTEXT, INCOME_KINGAKU, DELETE_FLG) VALUES
('user01', '2026', '01', '01', '1', '給与', 250000.00, false),
('user01', '2026', '01', '02', '2', '賞与', 50000.00, false);

-- 8-3. 支出テーブル（支出金額合計 = 240000）
INSERT INTO EXPENDITURE_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, EXPENDITURE_CODE,
    SISYUTU_ITEM_CODE, EVENT_CODE, EXPENDITURE_NAME, EXPENDITURE_KUBUN,
    EXPENDITURE_DETAIL_CONTEXT, SIHARAI_DATE, EXPENDITURE_ESTIMATE_KINGAKU, EXPENDITURE_KINGAKU, DELETE_FLG
) VALUES
('user01', '2026', '01', '001', '0002', NULL, 'スーパー買い物', '1', '食料品購入', '2026-01-05', 70000.00, 70000.00, false),
('user01', '2026', '01', '002', '0003', NULL, 'レストラン', '1', '外食', '2026-01-10', 40000.00, 40000.00, false),
('user01', '2026', '01', '003', '0005', NULL, '日用品購入', '1', '消耗品', '2026-01-15', 60000.00, 60000.00, false),
('user01', '2026', '01', '004', '0002', NULL, '食材まとめ買い', '1', '食料品購入', '2026-01-25', 70000.00, 70000.00, false);

-- 8-4. 支出金額テーブル（画面表示用の集計データ）
INSERT INTO SISYUTU_KINGAKU_TABLE (
    USER_ID, TARGET_YEAR, TARGET_MONTH, SISYUTU_ITEM_CODE,
    PARENT_SISYUTU_ITEM_CODE, SISYUTU_YOTEI_KINGAKU, SISYUTU_KINGAKU, SISYUTU_KINGAKU_B, SISYUTU_KINGAKU_C, SISYUTU_SIHARAI_DATE
) VALUES
('user01', '2026', '01', '0001', '0001', 180000.00, 180000.00, 140000.00, 40000.00, '2026-01-31'),
('user01', '2026', '01', '0002', '0001', 150000.00, 140000.00, 110000.00, 30000.00, '2026-01-25'),
('user01', '2026', '01', '0003', '0001', 40000.00, 40000.00, 30000.00, 10000.00, '2026-01-10'),
('user01', '2026', '01', '0004', '0004', 70000.00, 60000.00, 50000.00, 10000.00, '2026-01-15'),
('user01', '2026', '01', '0005', '0004', 70000.00, 60000.00, 50000.00, 10000.00, '2026-01-15');
